---
title: Docker - экономим время на установке приложений
description: В интернете не мало статей о Docker и каждый рассматривает его плюсы со своей колокольни, для меня это интструмент, который позволяет экономить кучу времени при развертывании моего проекта и установки различных зависимостей, служб, программного обеспечения.
category: blog
lang: ru
---
В интернете не мало статей о <b>Docker</b> и каждый рассматривает его плюсы со своей колокольни, для меня это интструмент, который позволяет экономить кучу времени при развертывании моего проекта и установки различных зависимостей, служб, программного обеспечения.

В интернете не мало статей о <b>Docker</b> и каждый рассматривает его плюсы со своей колокольни, для меня это интструмент, который позволяет экономить кучу времени при развертывании моего проекта и установки различных зависимостей, служб, программного обеспечения. </p>

<p>Предположим, у вас проект, 3 среды (тестовая, предпродуктовая, продуктовая), есть поисковый движок <a href="https://www.elastic.co/" rel="nofollow" target="_blank">Elasticsearch</a>, база данных <a href="https://www.postgresql.org/" rel="nofollow" target="_blank">PostgreSQL</a>, и нереляционное хранилище данных <a href="https://redis.io/" rel="nofollow" target="_blank">Redis</a>.
</p>
<p>
	Теперь у нас стоит задача, чтобы на всех окружениях были идентичные параметры/настройки всех служб и ПО и все они между собой работали без проблем, так как если не соблюдать такое правило, со временем может получится так, что на тестовом сервере у нас все отлично работает, а на бою все сломалось или к примеру на локальной машине разработчика все отрабатывает правильно, а на бою этот же код работать не хочет.
</p>
<p>Вот тут и поможет нам docker, в данной статье будет в основном практика, так как теории везде полно, теорию можно почитать к примеру <a href="https://habr.com/post/353238/" rel="nofollow" target="_blank"> тут </a>.</p>

<p>Приступим!</p>

<p>Основная суть docker - это взять ваш проект/код и загрузить его в отдельное изолированное окружение/процесс на базе готового образа и работать с ним внутри этого окружения.</p>

<p>Образы можно смотреть вот на этом ресурсе <a href="https://hub.docker.com" rel='nofollow' target='_blank'>hub.docker.com</a>, а так же создавать свои и заливать туда.</p>

<p>Для использования в своем проекте docker отвечают файлы <b>Dockerfile</b> и <b>docker-compose.yml (опционально)</b>, обычно их хранят в корне проекта.</p>
<p>
	В файле <b>Dockerfile</b> вы описываете работу контейнера для своего проекта, для написания инструкций используется язык DSL.
</p>
<p>Рассмотрим базовый пример Dockerfile для NodeJS:</p>
<pre>
<code class='makefile'>
#указываем какой образ нужно установить в наш контейнер
FROM node:8

#указываем рабочую папку проекта
WORKDIR /app

#копируем из нашей директории все файлы в WORKDIR
COPY . .

#устанавливаем все зависимости, запускаем команду npm install
RUN npm install

#доступ к контейнеру через порт 8080
EXPOSE 8080

#выполняем команду node index.js в WORKDIR
CMD [ "node", "index.js" ]
</code>
</pre>

<p>Пример Dockerfile для Golang:</p>
<pre>
<code class='makefile'>
#указываем какой образ нужно установить в наш контейнер
FROM golang

#копируем весь пакет, GOPATH в конетйнере лежит в /go/, путь зависит от проекта
COPY . /go/src/<путь до пакета>/

#устанавливаем рабочую директорию, путь зависити от проекта
WORKDIR /go/src/<путь до пакета>/

#устанавливаем нужны пакеты, можно все вынести в один makefile и запустить его
RUN go get github.com/jinzhu/gorm

#собираем приложение, тоже зависит от пути проекта
RUN go build -o main .

#доступ к контейнеру через порт 8080
EXPOSE 8080

#выполняем команду node index.js в WORKDIR
CMD [ "main" ]
</code>
</pre>

<p>После составления Dockerfile, в корне проекта, где лежит этот файл, нужно собрать контейнер и запустить его, хорошо написано об этом в офф документации вот <a href='https://docs.docker.com/get-started/part2/#build-the-app' target='_blank'>тут</a>.</p>

<p>Выше были показаны типовые/базовые Dockerfile для проекта, каждая команда имеет комментарий, для PHP есть образы сразу в связке с Apche, Nginx и т.п., для проектов на фреймворке Laravel использую <a target='_blank' href='https://Laradock.io'>laradock</a>.</p>

<p>Для проектов Bitrix, есть подобная сборка <a href='https://github.com/bitrixdock/bitrixdock' target='_blank'>bitrixdoc</a>.</p>

<p>Так же можете посмотреть примеры Dockerfile проекта maxkrasnov.ru, вот <a href='https://github.com/maxkrasnov/ru.maxkrasnov-front/blob/master/Dockerfile' target='_blank'>тут</a> для фронт-части, вот <a href='https://github.com/maxkrasnov/ru.maxkrasnov.api/blob/master/build/package/Dockerfile' target='_blank'>тут</a> для бэк.</p>



<p>
После того, как мы описали контейнер для своего проекта, мы хотим использовать различные сторонние сервисы/службы с ним, так же используя Docker. Для этого нам нужен файл <b>docker-compose.yml</b>, в нем описываются свзяи между контейнерами и указываются настройки. 
</p>

<p>О <b>docker-compose.yml</b> тоже хорошо написано в офф документации, вот <a href='https://docs.docker.com/compose/compose-file/#build' target='_blank'>тут</a>, настройки этого файла можно посмотреть в репозиториях данного проекта.</p>
